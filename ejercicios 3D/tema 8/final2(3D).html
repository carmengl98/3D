<!DOCTYPE html>
<html>

<head>
<title>Three.js: Collision detection</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/103/three.min.js"></script>


<script>
   var stepX = 0.15;
   //var stepY = 0.25;

   function init() {
     var scene = new THREE.Scene();
     var sceneWidth = window.innerWidth - 20;
     var sceneHeight = window.innerHeight - 20;

     var camera = new THREE.PerspectiveCamera(90, sceneWidth / sceneHeight, 0.01, 100);
     camera.position.set(0, 0, 15); //ver bieeen
     camera.lookAt(scene.position);

     var renderer = new THREE.WebGLRenderer({
        antialias : true
     });

     renderer.shadowMap.enabled = true;
     renderer.setSize(sceneWidth, sceneHeight);
     document.body.appendChild(renderer.domElement);

     var light = addLight(scene);
     var sphere = addSphere(scene);
     var floor = addFloor(scene);
     var border_left = addBorder(scene , 1, 20, 2, 5, 0, 0);
     var border_right = addBorder(scene , 1, 20, 2, -5, 0, 0);
     var cpu = addBorder(scene , 4 , 1, 2, 0, 11, 0);
     var usuario = addBorder(scene , 4, 1, 2, 0, -11, 0);
     
     animate(sphere, renderer, scene, camera);

   }

  function animate(sphere, renderer, scene, camera) {
    sphere.position.x += 0.1;
    renderer.render(scene, camera);

    requestAnimationFrame(function() {
       animate(sphere, renderer, scene, camera);
    });
  }

  function addLight(scene) {
     var light = new THREE.DirectionalLight();
     light.position.set(4, 4, 4);
     light.castShadow = true;
     light.shadow.camera.near = 0;
     light.shadow.camera.far = 16;
     light.shadow.camera.left = -8;
     light.shadow.camera.right = 5;
     light.shadow.camera.top = 10;
     light.shadow.camera.bottom = -10;
     light.shadow.mapSize.width = 4096;
     light.shadow.mapSize.height = 4096;
       scene.add(light);  //??
    }

  function addSphere(scene) {
    var geometry = new THREE.SphereGeometry(1, 20, 20);
    var material = new THREE.MeshNormalMaterial();
    var mesh_sphere = new THREE.Mesh(geometry, material);
    mesh_sphere.position.z = 1;
    mesh_sphere.castShadow = true;
    scene.add(mesh_sphere);
  }

  function addFloor(scene) {
   var geometry = new THREE.PlaneGeometry(10, 20);
   var material = new THREE.MeshNormalMaterial();     // quitaaar cuando pueda poner la madera
   var mesh_floor = new THREE.Mesh(geometry, material);
   mesh_floor.receiveShadow = true;
   scene.add(mesh_floor);
  }

  function addBorder(scene, x, y, z, posX, posY, posZ){
    var geometry = new THREE.BoxGeometry(x, y, z);
    var material = new THREE.MeshNormalMaterial();  // quitarr cuando pueda poner la madera
    var mesh_border = new THREE.Mesh(geometry, material);
    mesh_border.receiveShadow = true;
    mesh_border.position.set(posX, posY, posZ);
    scene.add(mesh_border);
  }

  function getMaterial() {
    var texture = new THREE.TextureLoader().load("wood.png");
    var material = new THREE.MeshPhysicalMaterial({
      map : texture
    });
   material.map.wrapS = material.map.wrapT = THREE.RepeatWrapping;
   material.map.repeat.set(4, 4);
   material.side = THREE.DoubleSide;

   return material;
  }

 // var render = function() {
 //    renderer.render(scene, camera);
 // };


  </script>


</head>

<body onload="init()">
</body>

</html>
